<!DOCTYPE html>
<html lang="kor" xmlns:th="http://www.thymeleaf.org">

<div th:replace= "~{usr/include/head :: head}"></div>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">

  <style>
	.garo {
		max-width: 1000px;  /* 예: 최대 너비를 1200px로 설정 */
		margin: 0 auto;  /* 중앙 정렬 */
	}
  
    body {
      font-family: sans-serif;
    }

    .search-box {
      display: flex;
      align-items: center;
      background-color: white;
      border-radius: 40px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      padding: 10px 20px;
      width: fit-content;
      gap: 30px;
    }

    .search-item {
      display: flex;
      flex-direction: column;
      font-size: 14px;
    }

    .search-item-title {
      color: #888;
      font-size: 12px;
      margin-bottom: 2px;
    }

    .search-item-value {
      font-weight: bold;
    }

    .divider {
      width: 1px;
      height: 30px;
      background-color: #ddd;
    }

    input[type="text"] {
      border: none;
      outline: none;
      font-size: 14px;
    }
    
    .checkin-item,
	.checkout-item {
	  flex-grow: 1;
	  min-width: 170px; /* 선택 사항: 최소 너비 보장 */
	}

  </style>


	<!--Breadcrumb start-->
	<div class="container">
		<div class="row">
<!-- 			<div class="col-12 py-4"> -->
<!-- 				<nav aria-label="breadcrumb"> -->
<!-- 					<ol class="breadcrumb mb-0"> -->
<!-- 						<li class="breadcrumb-item"><a href="#!">Home</a></li> -->
<!-- 						<li class="breadcrumb-item"><a href="#!">Shop</a></li> -->
<!-- 						<li class="breadcrumb-item"><a href="#!">Shopping Cart</a></li> -->
<!-- 						<li class="breadcrumb-item active" aria-current="page">Checkout</li> -->
<!-- 					</ol> -->
<!-- 				</nav> -->
<!-- 			</div> -->
			<div class="col-12">
				<!--Heading-->
				<div class="my-5 garo">
					<h1 class="mb-0">예약/결제</h1>
				</div>
			</div>
		</div>
	</div>
	<!--Breadcrumb end-->
	<!--Shopping checkout start-->
	<section class="pt-lg-4 pb-lg-8">
		<div class="container garo">
			<div class="row gx-lg-6 gy-4 gy-lg-0">
				<!--Shopping checkout detail-->
				<div class="col-lg-8">
					<div class="">
						<div class="d-flex justify-content-center align-items-center mb-2">
<!-- <div class="search-box"> -->
<!--   <div class="search-item"> -->
<!--     <div class="search-item-title">여행지</div> -->
<!--     <input type="text" placeholder="자동입력" disabled> -->
<!--   </div> -->

  <div class="divider"></div>

  <div class="search-item">
<!--     <div class="search-item-title">체크인 & 체크아웃</div> -->
    <!-- 달력 위치 여기 -->
    <div id="calendar"></div>
    <!-- 값 서버로 넘길 거면 hidden input 유지 -->
    <input type="hidden" id="checkin">
    <input type="hidden" id="checkout">
  </div>
<!-- </div> -->

						</div>

					</div>
				</div>
				<div class="col-lg-4">
<!-- 					<div class="mb-4"> -->
<!-- 						<div class="alert alert-success small">Congratulations 🎉 You are eligible for free shipping. -->
<!-- 						</div> -->
<!-- 					</div> -->
					<!--Order summary-->
					<div class="card bg-light bg-opacity-25 mb-4">
						<div class="card-header px-4 py-3">
							<h3 class="fs-5 mb-0">주문 요약</h3>
						</div>
						<div class="card-body px-4">
							<div class="d-flex justify-content-between mb-4">
								<div class="d-flex align-items-start gap-3 flex-wrap">
									<a href="#!"><img th:src="@{${item.image}}" 
											alt="product image" class="border" width="60" /></a>
											<!-- 여행지는 이미지가 없어서 사이트가 안열림 -->

									<div class="mb-2">
										<h3 class="fs-6 mb-1 text-link">
										  <a th:if="${type == 'restaurant'}"
										     th:text="${title}"
										     th:href="'/bada/restaurant/' + ${item.restaurantId}"></a>
										
										  <a th:if="${type == 'accom'}"
										     th:text="${title}"
										     th:href="'/bada/accom/' + ${item.accomId}"></a>
										     
										  <a th:if="${type == 'sea'}"
										  	 th:text="${title}"
										  	 th:href="'/bada/sea/' + ${item.sea_id}"></a>
										</h3>

<!-- 										<p class="mb-2 text-dark">Black</p> -->
									</div>
								</div>
								<div>
									<span class="text-dark">$78</span>
								</div>
							</div>
<div class="mb-2 border-top pt-3 mb-2">
  <div class="d-flex align-items-center justify-content-between mb-2">
    <span><b>체크인</b></span>
    <span id="selected-checkin">-</span>
  </div>
  <div class="d-flex align-items-center justify-content-between mb-2">
    <span><b>체크아웃</b></span>
    <span id="selected-checkout">-</span>
  </div>
							<div
								class="d-flex align-items-center justify-content-between border-top pt-3 mb-2 fw-medium text-dark">
								<span class="">총 금액 : </span>
								<span class="">$78.00 USD</span>
							</div>

						    <!-- 결제하기 버튼 -->
    						<button class="button btn btn-primary" style="margin-top: 30px" onclick="requestPayment()">결제하기</button>
  
  
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>

<script src="https://js.tosspayments.com/v2/standard"></script>

      <script>
      // ------  SDK 초기화 ------
      // @docs https://docs.tosspayments.com/sdk/v2/js#토스페이먼츠-초기화
      const clientKey = "test_ck_nRQoOaPz8Lxz2KndYGEe8y47BMw6";
      const customerKey = "haiwcxeVmfIN3FzlmAmV7";
      const tossPayments = TossPayments(clientKey);
      // 회원 결제
      // @docs https://docs.tosspayments.com/sdk/v2/js#tosspaymentspayment
      const payment = tossPayments.payment({ customerKey });
      // 비회원 결제
      // const payment = tossPayments.payment({customerKey: TossPayments.ANONYMOUS})

      // ------ '결제하기' 버튼 누르면 결제창 띄우기 ------
      // @docs https://docs.tosspayments.com/sdk/v2/js#paymentrequestpayment
      async function requestPayment() {
        // 결제를 요청하기 전에 orderId, amount를 서버에 저장하세요.
        // 결제 과정에서 악의적으로 결제 금액이 바뀌는 것을 확인하는 용도입니다.
        await payment.requestPayment({
          method: "CARD", // 카드 결제
          amount: {
            currency: "KRW",
            value: 1,
          },
          orderId: "n1CJ-fTjD3R4SkDDHoa8s", // 고유 주문번호
          orderName: "토스 티셔츠 외 2건",
          successUrl: window.location.origin + "/success", // 결제 요청이 성공하면 리다이렉트되는 URL
          failUrl: window.location.origin + "/fail", // 결제 요청이 실패하면 리다이렉트되는 URL
          customerEmail: "customer123@gmail.com",
          customerName: "김토스",
          customerMobilePhone: "01012341234",
          // 카드 결제에 필요한 정보
          card: {
            useEscrow: false,
            flowMode: "DEFAULT", // 통합결제창 여는 옵션
            useCardPoint: false,
            useAppCardOnly: false,
          },
        });
      }
    </script>



	<!--Shopping checkout end-->
	<!-- jQuery -->
	<script src="/usr/js/jquery-3.7.1.min.js"></script>
	<!-- Flatpickr -->
	<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
	<!-- Flatpickr 한국어 번역 -->
	<script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/ko.js"></script>
		
	<script type="text/javascript">
	
	// 달력
	$(function () {
		  const reservedRanges = [
		    { from: "2025-05-01", to: "2025-05-07" },
		    { from: "2025-05-15", to: "2025-05-17" }
		  ];

		  const calendar = flatpickr("#calendar", {
		    inline: true,
		    mode: "range",
		    dateFormat: "Y-m-d",
		    minDate: "today",
		    locale: "ko",
		    disable: reservedRanges,
		    showMonths: 2,  // 📌 여기 추가!
		    onChange: function(selectedDates) {
		      if (selectedDates.length === 2) {
		        $('#checkin').val(flatpickr.formatDate(selectedDates[0], "Y-m-d"));
		        $('#checkout').val(flatpickr.formatDate(selectedDates[1], "Y-m-d"));

		        $('#selected-checkin').text(flatpickr.formatDate(selectedDates[0], "Y-m-d"));
		        $('#selected-checkout').text(flatpickr.formatDate(selectedDates[1], "Y-m-d"));
		      }
		    }
		  });
		});

	</script>
    

<div th:replace= "~{usr/include/footer :: footer}"></div>
</html>